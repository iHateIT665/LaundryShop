<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Đặt lại mật khẩu</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container text-center mt-5">
        <h2>Đặt Lại Mật Khẩu</h2>
        
        <form th:action="@{/reset_password}" method="post" style="max-width: 400px; margin: 0 auto;">
            <input type="hidden" name="token" th:value="${token}" />
            
            <div th:if="${error != null}" class="alert alert-danger">
                [[${error}]]
            </div>

            <div class="mb-3">
                <input type="password" name="password" id="password" class="form-control" 
                       placeholder="Nhập mật khẩu mới (tối thiểu 6 ký tự)" 
                       required autofocus minlength="6" />
            </div>
            
            <div class="mb-3">
                 <input type="password" id="confirmPassword" class="form-control" 
                       placeholder="Xác nhận mật khẩu mới" required oninput="checkMatch(this)"/>
                 <div id="message" class="text-danger mt-1" style="font-size: 0.9em;"></div>
            </div>
            
            <div>
                <button type="submit" class="btn btn-primary">Đổi Mật Khẩu</button>
            </div>
        </form>
    </div>

    <script>
        function checkMatch(fieldConfirmPassword) {
            var password = document.getElementById("password").value;
            var confirmPassword = fieldConfirmPassword.value;
            var messageDiv = document.getElementById("message");

            if (confirmPassword != password) {
                fieldConfirmPassword.setCustomValidity('Mật khẩu không khớp!');
                messageDiv.innerHTML = "Mật khẩu xác nhận chưa khớp.";
            } else {
                fieldConfirmPassword.setCustomValidity('');
                messageDiv.innerHTML = "";
            }
        }
    </script>
</body>
</html>
</html>