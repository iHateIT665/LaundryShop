<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{common/head :: head('Lịch sử đơn hàng')}"></head>
<body class="bg-light">

    <nav th:replace="~{client/fragments/navbar :: navbar}"></nav>

    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-md-10">
                <div class="card shadow border-0">
                    <div class="card-header bg-primary text-white">
                        <h4 class="mb-0"><i class="fa-solid fa-clock-rotate-left me-2"></i>LỊCH SỬ ĐƠN HÀNG</h4>
                    </div>
                    <div class="card-body">
                        
                        <div th:if="${orders == null or orders.isEmpty()}" class="text-center py-5">
                            <img src="https://cdn-icons-png.flaticon.com/512/2038/2038854.png" width="100" class="mb-3 opacity-50">
                            <h5 class="text-muted">Bạn chưa có đơn hàng nào</h5>
                            <a th:href="@{/client/booking}" class="btn btn-primary mt-3">Đặt dịch vụ ngay</a>
                        </div>

                        <div th:if="${orders != null and !orders.isEmpty()}" class="table-responsive">
                            <table class="table table-hover align-middle">
                                <thead class="table-light">
                                    <tr>
                                        <th>Mã Đơn</th>
                                        <th>Ngày Đặt</th>
                                        <th>Địa Chỉ Giao</th>
                                        <th>Tổng Tiền</th>
                                        <th>Trạng Thái</th>
                                        <th>Hành Động</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr th:each="order : ${orders}">
                                        <td class="fw-bold text-primary">#[[${order.orderId}]]</td>
                                        
                                        <td th:text="${#temporals.format(order.createdAt, 'dd-MM-yyyy HH:mm')}"></td>
                                        
                                        <td th:text="${order.deliveryAddress}" style="max-width: 200px;" class="text-truncate"></td>
                                        
                                        <td class="fw-bold text-danger">
                                            [[${#numbers.formatDecimal(order.totalAmount, 0, 'COMMA', 0, 'POINT')}]] đ
                                        </td>

                                        <td>
                                            <span th:if="${order.status == 'PENDING'}" class="badge bg-warning text-dark">Chờ xác nhận</span>
                                            <span th:if="${order.status == 'CONFIRMED'}" class="badge bg-info text-dark">Đã xác nhận</span>
                                            <span th:if="${order.status == 'PROCESSING'}" class="badge bg-primary">Đang giặt</span>
                                            <span th:if="${order.status == 'SHIPPING'}" class="badge bg-primary">Đang giao</span>
                                            <span th:if="${order.status == 'COMPLETED'}" class="badge bg-success">Hoàn thành</span>
                                            <span th:if="${order.status == 'CANCELLED'}" class="badge bg-secondary">Đã hủy</span>
                                        </td>

                                        <td>
                                            <a th:href="@{/client/history/{id}(id=${order.orderId})}" class="btn btn-sm btn-outline-primary">
                                                <i class="fa-solid fa-eye"></i> Xem
                                            </a>
                                            <a th:if="${order.status == 'PENDING'}" 
                                               th:href="@{/client/history/cancel/{id}(id=${order.orderId})}"
                                               class="btn btn-sm btn-outline-danger"
                                               onclick="return confirm('Bạn chắc chắn muốn hủy đơn này?');">
                                                <i class="fa-solid fa-trash"></i> Hủy
                                            </a>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div th:replace="~{common/scripts :: scripts}"></div>
</body>
</html>